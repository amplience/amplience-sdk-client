!function(a){a.widget("amp.ampStack",{options:{delay:3e3,autoplay:!1,loop:!0,fade:!1,start:1,responsive:!0,center:!1,parentSize:!1,gesture:{enabled:!1,fingers:1,dir:"horz",distance:50},states:{selected:"amp-selected",seen:"amp-seen"}},_getCreateOptions:function(){var b=this.element.data().ampStack;return b?a.extend(!0,{},this.options,b):this.options},_create:function(){var b=this,c=this._children=this.element.children();this.canTouch=!!("ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch),this.element.addClass("amp"),this.element.addClass("amp-stack"),this.count=this._children.length,this._index=Math.max(1,Math.min(this.options.start,this.count)),c.addClass("amp-layer"),c.css({display:"none"}),c.eq(this._index-1).css("display","block"),c.eq(this._index-1).addClass(this.options.states.selected+" "+this.options.states.seen),this._addGestures(),this.options.autoplay&&this.play(),setTimeout(function(a){return function(){return a._calcSize()}}(b),1),a(window).bind("resize",function(b){return function(){return setTimeout(a.proxy(b._calcSize,b),1)}}(b)),this._track("created",{index:this._index,canNext:this.canNext(),canPrev:this.canPrev()})},_addGestures:function(){if(this.options.gesture.enabled&&this.canTouch){this._startG=function(b){if(b.originalEvent&&b.originalEvent.touches&&b.originalEvent.touches[0]&&b.originalEvent.touches.length!=this.options.gesture.fingers)return!0;if(b.originalEvent&&b.originalEvent.target&&"range"===b.originalEvent.target.type)return!0;this.changed=!1,this.moved=!1,this.startTouchEvent=b;var b=this._getEvent(b);return this.startPos="horz"==this.options.gesture.dir?b.pageX-b.target.offsetLeft:b.pageY-b.target.offsetTop,a(window).on("touchmove",a.proxy(this._moveG,this)),a(window).on("touchcancel",a.proxy(this._stopG,this)),a(window).on("touchend",a.proxy(this._stopG,this)),!0},this._getEvent=function(a){return("touchend"==a.type||"touchcancel"==a.type)&&(a=this.lastEvent),a.originalEvent&&a.originalEvent.touches&&a.originalEvent.touches[0]&&(a=a.originalEvent.touches[0]),a},this._moveG=function(a){return a.originalEvent&&a.originalEvent.touches&&a.originalEvent.touches[0]&&a.originalEvent.touches.length!=this.options.gesture.fingers?!0:a.originalEvent&&a.originalEvent.target&&"range"===a.originalEvent.target.type?!0:(this.moved=!0,this.lastEvent=a,a=this._getEvent(a),("horz"==this.options.gesture.dir?a.pageX-this.startPos:a.pageY-this.startPos!=0)?!1:!0)},this._stopG=function(b){if(a(window).off("touchmove",a.proxy(this._moveG,this)),a(window).off("touchcancel",a.proxy(this._stopG,this)),a(window).off("touchend",a.proxy(this._stopG,this)),this.moved&&!this.changed){this.changed=!0,b=this._getEvent(b);var c="horz"==this.options.gesture.dir?b.pageX-b.target.offsetLeft:b.pageY-b.target.offsetTop,d=c-this.startPos;if(Math.abs(d)<this.options.gesture.distance)return;d>0?this.prev():this.next()}},this._children.on("touchstart",a.proxy(this._startG,this))}},_getIndex:function(a){var b=this._children;if(a>b.length){if(!this.options.loop)return a;for(;a>b.length;)a-=b.length}else if(1>a){if(!this.options.loop)return a;for(;1>a;)a+=b.length}return a},play:function(){var a=this;clearInterval(this.interval),this.interval=setInterval(function(){a.next()},this.options.delay),this._track("play",null)},pause:function(){clearInterval(this.interval),this._track("pause",null)},next:function(){this.goTo(this._index+1)},prev:function(){this.goTo(this._index-1)},redraw:function(){this._calcSize()},_calcSize:function(){var a,b;if(this.options.responsive&&this.options.width&&this.options.height&&"auto"!=this.options.width&&"auto"!=this.options.height)this.options.parentSize?(a=Math.round(this.element.parent().width()),b=Math.round(a*(this.options.height/this.options.width)),b>this.element.parent().height()&&(b=this.element.parent().height(),a=Math.round(b*(this.options.width/this.options.height))),this.element.width(a),this.element.height(b)):(a=Math.round(this.element.width()),b=Math.round(a*(this.options.height/this.options.width)),this.element.height(b)),this.options.center&&(this.element.css("margin-left",this.element.parent().width()/2-a/2+"px"),this.element.css("margin-top",this.element.parent().height()/2-b/2+"px"));else{if(this.options.width&&"auto"!=this.options.width)this.element.width(this.options.width);else if("auto"==this.options.width){for(var c=0,d=0;d<this.count;d++)for(var d=0;d<this.count;d++){var e=this._children.eq(d),f=e.css("display");e.css("display","block"),c=Math.max(e.outerWidth(!0),c),e.css("display",f)}this.element.width(c)}if(this.options.height&&"auto"!=this.options.height)this.element.height(this.options.height);else if("auto"==this.options.height){for(var c=0,d=0;d<this.count;d++)for(var d=0;d<this.count;d++){var e=this._children.eq(d),f=e.css("display");e.css("display","block");var b=e.outerHeight(!0);c=Math.max(e.outerHeight(!0),c),e.css("display",f)}this.element.height(c)}}},_onFinish:function(){for(var a=1,b=this;0!=this._asyncMethods.length;){var c=this._asyncMethods.splice(0,1)[0];c.func&&c.args&&(setTimeout(function(){c&&c.func&&c.func.apply(b,c.args)},a),a++)}},visible:function(a,b){a!=this._visible&&(this._track("visible",{visible:a}),this._visible=a,this.callChildMethod(this._children.eq(this._index-1),"visible",a),a&&this._calcSize())},callChildMethod:function(b,c,d){var e=function(b){for(var f=0;f<b.length;f++){var g=!1,h=a(b[f]),i=h.data();for(var j in i)if(i.hasOwnProperty(j)){var k=i[j];k[c]&&"function"==typeof k[c]&&"amp"==j.substring(0,3)&&(k[c](d),g=!0)}g||e(h.children())}};e(b.children())},goTo:function(a,b,c){if(a=parseInt(a),!isNaN(a)){if(this._animating)return void this._asyncMethods.push({func:this.goTo,args:arguments});if(b||this._exeBinds(a,"goTo"),this._getIndex(a)!=this._index){if(a>this.count){if(!this.options.loop)return;for(;a>this.count;)a-=this.count;this._track("looped","forwards")}else if(1>a){if(!this.options.loop)return;for(;1>a;)a+=this.count;this._track("looped","backwards")}c||this._animate(a)}}},_exeBinds:function(b,c){if(this._boundArray)for(var d=0;d<this._boundArray.length;d++){var e=this._boundArray[d];if(!c||c==e.on){var f=a(e.selector),g=f.data();for(var h in g)if(g.hasOwnProperty(h)){var i=g[h];i[e.action]&&"amp"==h.substring(0,3)&&i[e.action](b,!0)}}}},_numToIndex:function(a){if(a>this.count){if(!this.options.loop)return this.count;for(;a>this.count;)a-=this.count}else if(1>a){if(!this.options.loop)return 1;for(;1>a;)a+=this.count}return a},bind:function(a){this._boundArray||(this._boundArray=[]),this._boundArray.push(a)},canPrev:function(){return this.options.loop||this._index>1},canNext:function(){return this.options.loop||this._index<this.count},_animate:function(a){var b=this.element,c=b.children("li").eq(this._index-1),d=b.children("li").eq(a-1);c.removeClass(this.options.states.selected),this.options.fade?c.fadeOut():c.css("display","none"),d.addClass(this.options.states.selected+" "+this.options.states.seen),this.options.fade?d.fadeIn():d.css("display","block"),this._setIndex(a)},_setIndex:function(a){var b=this._children.eq(this._index-1),c=this._children.eq(a-1);this.callChildMethod(c,"visible",!0),this.callChildMethod(b,"visible",!1),this._index=a,this._track("change",{index:a,canPrev:this.canPrev(),canNext:this.canNext()})},_track:function(a,b){this._trigger(a,null,b),window.amp&&amp.stats&&amp.stats.event&&amp.stats.event(this.element,"stack",a,b)},_destroy:function(){this.element.removeClass("amp"),this.element.removeClass("amp-stack"),this._removeEmptyAttributeHelper(this.element);var b=this._children;b.removeClass("amp-layer"),b.removeClass(this.options.states.selected),b.removeClass(this.options.states.seen),b.css("display","");for(var c=0,d=b.length;d>c;c++)this._removeEmptyAttributeHelper(a(b[c]))},_removeEmptyAttributeHelper:function(a,b){for(var c=b||["class","style"],d=0,e=c.length;e>d;d++)a.attr(c[d])&&a.prop(c[d])||a.removeAttr(c[d])}})}(jQuery),function(a){a.widget("amp.ampCarousel",a.amp.ampStack,{options:{animDuration:250,easing:"",dir:"horz",animate:!0,layout:"standard",start:1,preferForward:!1,no3D:!1,gesture:{enabled:!1,fingers:2,distance:50},onActivate:{select:!0,goTo:!0},preloadNext:!0,responsive:!0,states:{visible:"amp-visible",partiallyVisible:"amp-partially-visible"}},_getCreateOptions:function(){var b=this.element.data().ampCarousel;return b?a.extend(!0,{},this.options,b):this.options},_layoutManagers:{},_create:function(){this._elms=[],this._visible=0,this._asyncMethods=[],this._canNext=!0;var b=this;if(this.options.delay=Math.max(this.options.delay,this.options.animDuration+1),this.options.animDuration=this.options.animate?this.options.animDuration:1,this.canTouch=!!("ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch),this.element.addClass("amp"),this.element.addClass("amp-carousel"),this.element.wrapInner("<div class='amp-anim-container' style='width:100%;height:100%;position:absolute'></div>"),this._container=this.element.children().eq(0),this._containerPos=0,this._children=this.element.children().eq(0).children(),this.count=this._children.length,this._checkCSS3(),this._index=Math.max(1,Math.min(this.options.start,this.count)),this._selectedIndex=this._index,this._children.addClass("amp-slide"),this._calcSize(),this._chooseLayoutManager(),this._children.eq(this._index-1).addClass(this.options.states.selected),this.options.onActivate.goTo||this.options.onActivate.select)for(var c=0;c<this.count;c++){var d=function(){b.moved=!1,setTimeout(function(){a(window).on(this.canTouch?"touchmove":"mousemove",a.proxy(e,b))},1)},e=function(){b.moved=!0},f=function(c){var d=b;return function(f){return a(window).off(this.canTouch?"touchmove":"mousemove",a.proxy(e,b)),d.moved?!0:(d.options.onActivate.goTo&&d.goTo(c),d.options.onActivate.select&&d.select(c),!0)}}(c+1);this._children.eq(c).on(this.canTouch?"touchstart":"mousedown",a.proxy(d,b)),this._children.eq(c).on(this.canTouch?"touchend":"mouseup",a.proxy(f,b))}this._calcSize(),setTimeout(a.proxy(this._calcSize,this),1),this.options.responsive&&a(window).bind("resize",function(b){return function(){return setTimeout(a.proxy(b.redraw,b),1)}}(b)),this.options.autoplay&&this.play(),this._preloadNext(),this._track("created",{index:this._index,canNext:this.canNext(),canPrev:this.canPrev(),visible:this._visible,count:this.count})},_chooseLayoutManager:function(){var a,b;if("[object Array]"===Object.prototype.toString.call(this.options.layout)){for(var c=0;c<this.options.layout.length;c++)if(b=this._layoutManagers[this.options.layout[c]],this.checkFeatures(b)){a=b;break}}else b=this._layoutManagers[this.options.layout],this.checkFeatures(b)&&(a=b);a||(a=this._layoutManagers.standard),this._layoutManager=a.create(this)},_calcSize:function(){this._super(),this._layoutManager&&this._layoutManager.layout(this._index),this._track("resized",{index:this._index,canNext:this.canNext(),canPrev:this.canPrev(),visible:this._visible,count:this.count})},_firstCharLowerCase:function(a){return a.substr(0,1).toLowerCase()+a.substr(1)},_dashConvert:function(a){for(var b="",c=0;c<a.length;c++){var d=a.substr(c,1);b+=d===d.toUpperCase()?"-"+d.toLowerCase():d}return b},_checkCSS3:function(){var a=["","Webkit","Moz","O","ms","Khtml"],b=[{name:"transform",dom:"Transform"},{name:"transition",dom:"Transition"},{name:"transitionDuration",dom:"TransitionDuration"},{name:"transitionTimingFunction",dom:"TransitionTimingFunction"},{name:"anim",dom:"AnimationName"}],c=this.element[0],d=document.createElement("p");this._canCSS3={},document.body.insertBefore(d,null);for(var e=0;e<a.length;e++)for(var f=a[e],g=0;g<b.length;g++){var h=b[g];this._canCSS3[h.name]||(void 0!==c.style[f+h.dom]&&(this._canCSS3[h.name]=f+h.dom),void 0!==c.style[f+this._firstCharLowerCase(h.dom)]&&(this._canCSS3[h.name]=f+this._firstCharLowerCase(h.dom)))}if(this._canCSS3.transform&&!this.options.no3D&&void 0!==d.style[this._canCSS3.transform]){d.style[this._canCSS3.transform]="translate3d(1px,1px,1px)";var i=window.getComputedStyle(d).getPropertyValue(this._dashConvert(this._canCSS3.transform));this._canCSS3.can3D=null!=i&&""!=i}document.body.removeChild(d)},_direction:function(a){if(!this.options.loop)return a>this._index;var b=0,c=0;this._index=Math.min(this._index,this.count);for(var d=this._index;d!=a;)d>this.count?d=1:(d++,b++);for(d=this._index;d!=a;)1>d?d=this.count:(d--,c++);return this.options.preferForward&&b>1&&c>1?!0:c>=b},_loopIndex:function(a,b,c){for(var d=a?1:-1,e=b,f=0;c>f;f++)e+d>this.count?e=1:1>e+d?e=this.count:e+=d;return e},_loopCount:function(a,b,c){c=Math.min(c,this.count);for(var d=a?1:-1,e=b,f=0;e!=c;)f++,e+d>this.count?e=1:1>e+d?e=this.count:e+=d;return f},_resetPos:function(a){this._canCSS3.transform&&this._canCSS3.transition?a.css(this._canCSS3.transform,""):"horz"==this.options.dir?a.css("left",""):a.css("top","")},_removeStates:function(){this._children.removeClass(this.options.states.visible),this._children.removeClass(this.options.states.partiallyVisible)},_setState:function(a,b){switch(b){case"visible":a.addClass(this.options.states.visible),a.addClass(this.options.states.seen),this.callChildMethod(a,"visible",!0);break;case"invisible":a.removeClass(this.options.states.visible),this.callChildMethod(a,"visible",!1);break;case"partial":a.addClass(this.options.states.partiallyVisible),this.callChildMethod(a,"visible",!1)}},_posElm:function(a,b,c,d){this._elms[c]||(this._elms[c]=0);var e=d?this._elms[c]+b:b;this._canCSS3.transform&&this._canCSS3.transition?this._canCSS3.can3D?"horz"==this.options.dir?a.css(this._canCSS3.transform,"translate3d("+e+"px,0,0)"):a.css(this._canCSS3.transform,"translate3d(0,"+e+"px,0)"):"horz"==this.options.dir?a.css(this._canCSS3.transform,"translate("+e+"px,0)"):a.css(this._canCSS3.transform,"translate(0,"+e+"px)"):"horz"==this.options.dir?a.css("left",e+"px"):a.css("top",e+"px"),this._elms[c]=e},_preloadNext:function(){if(this.options.preloadNext){var a=this._loopIndex(!0,this._index,1),b=this._children.eq(a-1);this.callChildMethod(b,"preload",!0)}},_measureElements:function(a,b,c){for(var d=0,e=("horz"==this.options.dir,0);c>e;e++){var f=a?b+e:b-e;f>this.count&&(f=1),1>f&&(f=this.count),d+=this._measureElement(f-1)}return a?0-d:d},_moveElements:function(a,b,c){var d=this._container,e=this;if(this._containerPos==a)return e._canCSS3.transform&&e._canCSS3.transitionDuration&&(d.css(e._canCSS3.transitionTimingFunction,""),d.css(e._canCSS3.transitionDuration,"")),void(b&&b());if(this._containerPos=a,!c){if(e._canCSS3.transform&&e._canCSS3.transitionDuration){var f=e._canCSS3.can3D?"horz"==e.options.dir?"translate3d("+a+"px,0,0)":"translate3d(0, "+a+"px,0)":"horz"==e.options.dir?"translateX("+a+"px)":"translateY("+a+"px";d.css(e._canCSS3.transform,f)}else"horz"==e.options.dir?d.css("left",a+"px"):d.css("top",a+"px");return void(b&&b())}if(e._canCSS3.transform&&e._canCSS3.transitionDuration){var f=e._canCSS3.can3D?"horz"==e.options.dir?"translate3d("+a+"px,0,0)":"translate3d(0, "+a+"px,0)":"horz"==e.options.dir?"translateX("+a+"px)":"translateY("+a+"px";d.css(e._canCSS3.transform,f),d.css(e._canCSS3.transitionTimingFunction,e.options.easing),d.css(e._canCSS3.transitionDuration,e.options.animDuration+"ms"),d.off().on("transitionend webkitTransitionEnd oTransitionEnd otransitionend MSTransitionEnd",function(){d.css(e._canCSS3.transitionTimingFunction,""),d.css(e._canCSS3.transitionDuration,""),b&&b()})}else{var g={};"horz"==e.options.dir?g.left=a+"px":g.top=a+"px",d.animate(g,e.options.animDuration,"swing",b)}},_measureElement:function(a){var b,c="horz"==this.options.dir,d=this._children.eq(a);return d.css("display","block"),b=c?d.outerWidth(!0):d.outerHeight(!0),d.css("display",""),b},_elmSize:function(){return"horz"==this.options.dir?this.element.width():this.element.height()},_animate:function(a){var b=this;this._animating=!0,this._layoutManager.focus(a,!0,function(){b._setIndex(a)})},_setIndex:function(a){this._index=a,this._track("change",{index:this._index,canNext:this.canNext(),canPrev:this.canPrev(),visible:this._visible,count:this.count}),this._animating=!1,this._preloadNext(),this._onFinish()},_track:function(a,b){this._trigger(a,null,b),window.amp&&amp.stats&&amp.stats.event&&amp.stats.event(this.element,"carousel",a,b)},_destroy:function(){this.element.removeClass("amp"),this.element.removeClass("amp-carousel"),this._removeEmptyAttributeHelper(this.element);var a=this._children;a.removeClass("amp-slide"),a.removeClass(this.options.states.visible),a.removeClass(this.options.states.partiallyVisible),a.removeClass(this.options.states.selected),a.removeClass(this.options.states.seen);for(var b=0;b<a.length;b++){var c=a.eq(b);this._resetPos(c,0),this._removeEmptyAttributeHelper(c)}this._container.replaceWith(a)},checkFeatures:function(a){if(a){if(a.requiredFeatures){for(var b=!0,c=0;c<a.requiredFeatures.length;c++){var d=a.requiredFeatures[c];this._canCSS3[d]||(b=!1)}return b}return!0}return!1},canNext:function(){return this.options.loop||this._canNext&&this._index<this.count},redraw:function(){return this._animating?void this._asyncMethods.push({func:self._calcSize,args:arguments}):this._calcSize()},select:function(a,b){var c=this._numToIndex(a),d=this._children.eq(this._selectedIndex-1),e=this._children.eq(c-1);d.removeClass(this.options.states.selected),e.addClass(this.options.states.selected+" "+this.options.states.seen),this._selectedIndex=c,e.hasClass(this.options.states.visible)||this.goTo(c,b),b||this._exeBinds(c,"select"),this._preloadNext(),this._track("selected",{index:c})}}),function(){var b=function(b,c){function d(){this.name="standard",this.options=c,this.duplicated=[]}var e=d.prototype;e.init=function(){b.canTouch&&b.options.gesture.enabled&&b._children.on("touchstart",a.proxy(this.start,this))},e.start=function(c){if(!this.animating){if(c.originalEvent&&c.originalEvent.touches&&c.originalEvent.touches[0]&&c.originalEvent.touches.length!=b.options.gesture.fingers)return!0;this.duplicationOffsets={},this.duplicationOffsets.left=0,this.duplicationOffsets.leftSize=0,this.duplicationOffsets.right=0,this.duplicationOffsets.rightSize=0,this.changed=!1,this.startPos=b._containerPos,this.moved=!1,this.startTouchEvent=c;var c=this.getEvent(c);return this.xo=c.pageX-b._containerPos,this.yo=c.pageY-b._containerPos,this.xo2=c.pageX,this.yo2=c.pageY,a(window).on("touchmove",a.proxy(this.move,this)),a(window).on("touchcancel",a.proxy(this.stop,this)),a(window).on("touchend",a.proxy(this.stop,this)),!0}},e.move=function(a){if(a.originalEvent&&a.originalEvent.touches&&a.originalEvent.touches[0]&&a.originalEvent.touches.length!=b.options.gesture.fingers)return!0;this.moved=!0,this.lastEvent=a,a=this.getEvent(a);var c=a.pageX-this.xo,d=a.pageY-this.yo,e=a.pageX-this.xo2,f=a.pageY-this.yo2;if(this.moveDir||(Math.abs(e)<Math.abs(f)?this.moveDir="vert":Math.abs(e)>Math.abs(f)?this.moveDir="horz":this.moveDir=b.options.dir),b.options.dir!=this.moveDir)return!0;var g="horz"==b.options.dir?c:d;return b._moveElements(g,null,!1),b.options.loop&&this.checkDuplicate(g),b.options.dir==this.moveDir?!1:void 0},e.checkDuplicate=function(a){a-this.metrics[this.lastOne-1].size<0-(this.allSize-b._elmSize())&&this.duplicateSlide(!0),0-a-this.metrics[0].size<=0-this.duplicationOffsets.leftSize&&this.duplicateSlide(!1)},e.duplicateSlide=function(a){if(a){var c=b._numToIndex(b._index-1+b.count+this.duplicationOffsets.right+1)-1,d=b._children.eq(c),e=d.clone();b._container.append(e);var f="horz"==b.options.dir?e.width():e.height(),g=this.allSize;b._posElm(e,g,this.count+this.duplicated.length),this.duplicated.push(e),this.duplicationOffsets.right++,this.duplicationOffsets.rightSize+=f,this.lastOne=c+1,this.allSize+=f}else{var c=b._numToIndex(b._index-1-this.duplicationOffsets.left)-1,d=b._children.eq(c),e=d.clone();b._container.append(e);var f="horz"==b.options.dir?e.width():e.height(),g=0-this.duplicationOffsets.leftSize-f;b._posElm(e,g,this.count+this.duplicated.length),this.duplicated.push(e),this.duplicationOffsets.left++,this.duplicationOffsets.leftSize+=f}},e.stop=function(c){if(a(window).off("touchmove",a.proxy(this.move,this)),a(window).off("touchcancel",a.proxy(this.stop,this)),a(window).off("touchend",a.proxy(this.stop,this)),this.moveDir=null,this.moved&&!this.changed){var d=this.findNearest(),e=d.index+1;if(e==b._index){var f=this.startPos-b._containerPos;return Math.abs(f)>=b.options.gesture.distance?f>0?b.canNext()?b.next():b._moveElements(this.startPos,null,!0):b.canPrev()?b.prev():b._moveElements(this.startPos,null,!0):b._moveElements(this.startPos,null,!0),this.changed=!0,void(b.options.loop&&(b._containerPos=0))}b.options.loop?(this.animating=!0,b._moveElements(d.pos,a.proxy(function(){this.allSize=this.oAllSize,this.focus(e,!1),b._containerPos=0,b._setIndex(e),b.goTo(e,null,!0),this.changed=!0,this.animating=!1},this),!0)):(this.changed=!0,b.goTo(e))}},e.getEvent=function(a){return("touchend"==a.type||"touchcancel"==a.type)&&(a=this.startTouchEvent),a.originalEvent&&a.originalEvent.touches&&a.originalEvent.touches[0]&&(a=a.originalEvent.touches[0]),a},e.findNearest=function(){var a=0,c=b._containerPos,d=this.oAllSize,e=0;if(b.options.loop){for(;c<0-this.oAllSize;)c+=this.oAllSize,e--;for(;c>0;)c-=this.oAllSize,e++}for(var f=0;f<this.metrics.length;f++){var g=Math.abs(c+this.metrics[f].pos);d>g&&(d=g,a=f)}var h=b._numToIndex(b._index+b.count-1)-1,g=Math.abs(c+(this.metrics[h].pos+this.metrics[h].size));d>g&&(d=g,a=b._index-1,c+=this.oAllSize);var i=c>=0?this.metrics[a].pos+this.oAllSize*(e-1):0-this.metrics[a].pos+this.oAllSize*e;return{index:a,pos:i}},e.layout=function(a){b.options.loop?this.arrange(a):(this.arrange(1),this.focusNoLoop(a,!1))},e.focus=function(a,c,d){b.options.loop?this.focusLoop(a,c,d):(this.focusNoLoop(a,c),d&&d())},e.focusNoLoop=function(a,c){var d=0-this.metrics[a-1].pos,e=0-(this.allSize-b._elmSize());d=Math.min(Math.max(e,d),0),this.setVisibleStates(a,d),b._moveElements(d,null,c)},e.setVisibleStates=function(a,c){var c=Math.abs(c);b._removeStates();for(var d=0,e=0;e<this.metrics.length;e++){var f=this.metrics[e].pos,g=b._children.eq(e),h=this.metrics[e].size,i=2*parseFloat(b._children.eq(e).css("margin-right"));f>=c&&f+h-i-c<=b._elmSize()?(b._setState(g,"visible"),d++):f+h-i>c&&f+h-i-c<=b._elmSize()||f>=c&&f-c<b._elmSize()?b._setState(g,"partial"):b._setState(g,"invisible")}b._visible=d},e.focusLoop=function(a,c,d){var e=this,f=b._direction(a),g=f?0-this.metrics[a-1].pos:this.allSize-this.metrics[a-1].pos;b._loopCount(f,b._index,a);this.duplicate(f),b._moveElements(g,function(){for(b._container[0].style[b._canCSS3.transform]="","horz"===b.options.dir?b._container[0].style.left="":b._container[0].style.top="",e.arrange(a);e.duplicated.length>0;){var c=e.duplicated.splice(0,1);c[0].remove(),delete c[0]}d&&d()},c)},e.duplicate=function(a){for(var c=0;c<b.count;c++){var d=b._children.eq(c),e=d.clone();b._container.append(e);var f=a?this.metrics[c].pos+this.allSize:this.metrics[c].pos-this.allSize;b._posElm(e,f,this.count+this.duplicated.length),this.duplicated.push(e)}},e.arrange=function(a){var c=0,d=[],e=[];b._removeStates();for(var f=0;f<b.count;f++){var g=f;if(void 0!==a)for(g+=a-1;g>=b.count;)g-=b.count;var h=b._children.eq(g),i=b._measureElement(g);i+c<=b._elmSize()?b._setState(h,"visible"):c<b._elmSize()?b._setState(h,"partial"):b._setState(h,"invisible"),d[g]={},d[g].size=i,d[g].pos=c,b._posElm(h,c,g),e[g]=i,c+=i}return b.options.loop&&(b._containerPos=0),this.lastOne=a,delete this.metrics,this.metrics=d,this.allSize=c,this.oAllSize=c,{allSize:c,metrics:d}};var f=new d;return f.init(),f};a.amp.ampCarousel.prototype._layoutManagers.standard={requiredFeatures:null,create:b}}(),function(){var b=function(b,c){function d(){this.name="carousel3D",this.options=c,this.styles=[],this.angles=[]}var e=b._canCSS3.transform,f=d.prototype;f.init=function(){var c=this;this.element=b._container[0],this.rotation=0,this.panelCount=b.count,this.totalPanelCount=this.element.children.length,this.theta=0,this.isHorizontal="horz"==b.options.dir,b._container.css("perspective","1000px"),this.modify(),setTimeout(function(){c.animation(!0)},10),b.canTouch&&b.options.gesture.enabled&&b._children.on("touchstart",a.proxy(this.start,this))},f.animation=function(a){a?(b._children.css("transitionTimingFunction",b.options.easing),b._children.css("transitionDuration",b.options.animDuration+"ms")):(b._children.css("transitionTimingFunction",""),b._children.css("transitionDuration",""))},f.start=function(c){if(c.originalEvent&&c.originalEvent.touches&&c.originalEvent.touches[0]&&c.originalEvent.touches.length!=b.options.gesture.fingers)return!0;var c=this.getEvent(c);this.xo=c.pageX-c.target.offsetLeft,this.yo=c.pageY-c.target.offsetTop,this.changed=!1,this.moved=!1,this.animation(!1),this.startPos=this.rotation,a(window).on("touchmove",a.proxy(this.move,this)),a(window).on("touchcancel",a.proxy(this.stop,this)),a(window).on("touchend",a.proxy(this.stop,this))},f.move=function(a){if(a.originalEvent&&a.originalEvent.touches&&a.originalEvent.touches[0]&&a.originalEvent.touches.length!=b.options.gesture.fingers)return!0;this.lastEvent=a,this.moved=!0,a=this.getEvent(a);var c=a.pageX-this.xo,d=this.yo-a.pageY,e="horz"==b.options.dir?c:d;return e=e>0?Math.min(this.theta/2,e/10):Math.max(0-this.theta/2,e/10),this.rotation=this.startPos+e,this.transform(),!1},f.getEvent=function(a){return("touchend"==a.type||"touchcancel"==a.type)&&(a=this.lastEvent),a.originalEvent&&a.originalEvent.touches&&a.originalEvent.touches[0]&&(a=a.originalEvent.touches[0]),a},f.stop=function(c){if(a(window).off("touchmove",a.proxy(this.move,this)),a(window).off("touchcancel",a.proxy(this.stop,this)),a(window).off("touchend",a.proxy(this.stop,this)),this.animation(!0),this.moved&&!this.changed){c=this.getEvent(c);var d=c.pageX-this.xo,e=this.yo-c.pageY,f="horz"==b.options.dir?d:e;if(this.rotation=this.startPos,Math.abs(f)>=b.options.gesture.distance)if(0>f){if(b.canNext())return void b.next()}else if(b.canPrev())return void b.prev();this.transform(),this.changed=!0}},f.modify=function(){var a,c,d;for(this.xOffset=b._container.width()/2-b._children.eq(0).width()/2,this.yOffset=b._container.height()/2-b._children.eq(0).height()/2,this.panelSize=this.isHorizontal?b._children.eq(0).width():b._children.eq(0).height(),this.rotateFn=this.isHorizontal?"rotateY":"rotateX",this.theta=360/this.panelCount,this.radius=Math.round(this.panelSize/2/Math.tan(Math.PI/this.panelCount)),delete this.styles,delete this.angles,this.styles=[],this.angles=[],d=0;d<this.panelCount;d++)a=this.element.children[d],a&&(c=this.theta*d,this.angles[d]=c,this.styles[d]=this.rotateFn+"("+c+"deg) translateZ("+this.radius+"px)",a.style[e]=this.styles[d],"horz"==b.options.dir?a.style.left=this.xOffset+"px":a.style.top=this.yOffset+"px");for(;d<this.totalPanelCount;d++)a=this.element.children[d],a&&(a.style.opacity=0,a.style[e]="none");this.rotation=Math.round(this.rotation/this.theta)*this.theta,this.transform()},f.transform=function(){for(var a=0;a<this.panelCount;a++)if(this.element.children[a]){for(var b=this.angles[a]+this.rotation;b>360;)b-=360;for(;0>b;)b+=360;var c;c=180>=b?180-b:b-180,this.element.children[a].style.zIndex=c,this.element.children[a].style[e]="translateZ(-"+this.radius+"px) "+this.rotateFn+"("+this.rotation+"deg)"+this.styles[a]}},f.focus=function(a,c,d){var e=b._direction(a),f=b._loopCount(e,b._index,a),g=b._children.eq(a-1),h=b._children.eq(b._index-1);b._setState(g,"visible"),b._setState(h,"invisible"),e?this.rotation-=this.theta*f:this.rotation+=this.theta*f,this.transform(),d&&d()},f.layout=function(a){this.modify(),this.focus(a)};var g=new d;return g.init(),g};a.amp.ampCarousel.prototype._layoutManagers.carousel3D={requiredFeatures:["can3D","transform"],create:b}}()}(jQuery),function(a){a.widget("amp.ampImage",{options:{errImg:null,preload:"visible",insertAfter:!1},_loadedHistory:[],_getCreateOptions:function(){var b=this.element.data().ampImage;return b?a.extend(!0,{},this.options,b):this.options},_create:function(){this.element.addClass("amp"),this.element.addClass("amp-image");var b=this;this.element.bind("load",function(a){b._loaded()}),this.element.bind("error",function(){b._failLoad()}),-1==a.inArray(this.options.preload,["created","visible","none"])&&(this.options.preload="visible"),"created"==this.options.preload&&this.newLoad(),this._track("created")},newLoad:function(){var b=this.element.attr("src")&&""!=this.element.attr("src")?this.element.attr("src"):this.element.attr("data-amp-src");return-1!==a.inArray(b,this._loadedHistory)?(this.loading&&this.loading.remove(),this.element.attr("src",b),void this.element.show()):(this.loading||(this.loading=a('<div class="amp-loading"></div>')),this.element.hide(),this.options.insertAfter?this.options.insertAfter.prepend(this.loading):this.element.parent().append(this.loading),this.element.attr("src",""),void this.element.attr("src",b))},visible:function(a){a&&a!=this._visible&&"visible"==this.options.preload&&this.newLoad(),this._visible=a},load:function(a){this.loaded||this.loading||this.newLoad()},preload:function(){this.element.parent().hasClass("amp-spin")||this.newLoad()},loaded:!1,_loaded:function(){this._loadedHistory.push(this.element.attr("src")),this._track("loaded",!0),this.loaded=!0,this.loading&&this.loading.remove(),this.element.show()},_failLoad:function(){this.options.errImg?this.element.attr("src",this.options.errImg):window.amp&&amp.conf&&amp.conf.err_img&&this.element.attr("src",amp.conf.err_img)},_track:function(a,b){this._trigger(a,null,b),window.amp&&amp.stats&&amp.stats.event&&amp.stats.event(this.element,"image",a,b)},_destroy:function(){this.element.removeClass("amp"),this.element.removeClass("amp-image"),this.loading&&this.loading.remove(),this.element.css("display",""),this._removeEmptyAttributeHelper(this.element)},_removeEmptyAttributeHelper:function(a,b){for(var c=b||["class","style"],d=0,e=c.length;e>d;d++)a.attr(c[d])&&a.prop(c[d])||a.removeAttr(c[d])}})}(jQuery),function(a){a.widget("amp.ampBuild",{options:{},_create:function(){for(var b in a.amp)a.amp.hasOwnProperty(b)&&this.element.find("[data-"+b.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()+"]")[b]();this._track("created")},_track:function(a,b){this._trigger(a,null,b),window.amp&&amp.stats&&amp.stats.event&&amp.stats.event(this.element,"build",a,b)}})}(jQuery),function(a){a.widget("amp.ampNav",{options:{},_getCreateOptions:function(){var b=this.element.data().ampNav;return b?a.extend(!0,{},this.options,b):this.options},_create:function(){var a=this.element.data();for(var b in a)if(a.hasOwnProperty(b)){var c=a[b];c.bind&&"amp"==b.substring(0,3)&&c.bind(this.options)}this._track("created")},_track:function(a,b){window.amp&&amp.stats&&amp.stats.event&&amp.stats.event(this.element,"navigation",a,b)}})}(jQuery),function(a){var b={top:0,left:0,opacity:0,width:"",height:""};a.widget("amp.ampZoom",{options:{zoom:3,url:"",activate:{touch:"up",mouse:"up"},pan:!1,map:!1,target:{},lens:!0,fade:!0,preload:{image:"created",zoomed:"none"},responsive:!0,cursor:{active:"auto",inactive:"auto"},transforms:"",states:{active:"amp-active",inactive:"amp-inactive"},width:"auto",height:"auto",create:function(){},created:function(){},zoomedIn:function(){},zoomedOut:function(){},move:function(){},startMove:function(){},stopMove:function(){},startPreload:function(){},preloaded:function(){},visible:function(){}},_zoomLoaded:!1,_getCreateOptions:function(){this.validTypes=this._createValidTypes(this.options);var b=this.element.data().ampZoom;return b?a.extend(!0,{},this.options,b):this.options},_createValidTypes:function(a){var b={};for(var c in a)if(a.hasOwnProperty(c)){var d,e=a[c];d="width"==c||"height"==c?"number":typeof e,b[c]="object"==typeof e?this._createValidTypes(e):{type:d,defaultValue:e}}return b},_checkValidTypes:function(a,b){return a},_create:function(){this.options=this._checkValidTypes(this.options,this.validTypes),a.isArray(this.options.zoom)&&(this._cycle={current:-1,len:this.options.zoom.length
});var c=["created","visible","none"];-1==a.inArray(this.options.preload.image,c)&&(this.options.preload.image="created"),-1==a.inArray(this.options.preload.zoomed,c)&&(this.options.preload.zoomed="none"),this.element.addClass("amp amp-zoom"),this.element.wrap('<div class="amp-zoom-container"></div>'),this.parent=this.element.parent(),this.parent.prepend(this.loading),this.element.wrap('<div class="amp-zoom-overflow"></div>'),this.overflow=this.element.parent(),this.wrapper=a('<div class="amp-zoom-wrapper"></div>'),this.imgs=[];var d=0;do{var e=a('<img class="amp-zoom-img">');e.css(b),this.wrapper.append(e),this.imgs.push(e),d++}while(d<(this._cycle&&this._cycle.len));if(this.options.responsive&&this.element.css({height:"auto",width:"100%",maxWidth:"100%"}),this.options.target){this.mark=this.options.map?{name:"map",inner:"inner"}:{name:"box",inner:"wrapper"};try{this[this.mark.name]=a("body").find(this.options.target)}catch(f){this[this.mark.name]=!1}this[this.mark.name]&&this[this.mark.name].length>0?(this.options.lens&&(this.lens=a('<div class="amp-zoom-lens"></div>'),"map"==this.mark.name?(this[this.mark.name].addClass("amp-zoom-map"),this[this.mark.inner]=a('<div class="amp-zoom-wrapper"></div>'),this[this.mark.inner].append(a('<img class="amp-main-img" src="'+this.element.attr("src")+'">')),this[this.mark.inner].append(this.lens)):(this[this.mark.name].addClass("amp-zoom-container"),this.parent.append(this.lens))),this[this.mark.inner].hide(),this[this.mark.name].append(this[this.mark.inner]),this[this.mark.inner].addClass(this.options.states.inactive),this[this.mark.inner][0].relatedUUID=this.uuid):this[this.mark.name]=!1}this.box||(this.overflow.append(this.wrapper),this.canHideEl=!!a.amp.ampImage),this.target=this.imgs[0],this._setZoomCursor(this.parent),this.parent.addClass(this.options.states.inactive),("created"==this.options.preload.image||this.element[0].src)&&this._loadImage(),"created"==this.options.preload.zoomed&&this._loadZoomed()},_onImageLoad:function(){if(!this._imageLoaded){this._track("loaded",!0),this._imageLoaded=!0,this._imageLoading=!1,this._originalImage=this._getNaturalSize(this.element[0].src);var b=this;this._calcSize(),this.options.responsive&&a(window).bind("resize",function(a){return function(){return a.zoomed&&a.zoom(!1),a._calcSize()}}(b)),this.moved=!1,this.canTouch=!!("ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch),this.zoomBy=1,this.pos={start:{x:0,y:0},last:{x:0,y:0},cur:{x:0,y:0}};var c=function(){var c=function(a){return b.moved=!0,!0},d=function(a){return e(),!0},e=function(f){return b.pos.cur=b.pos.last,b.mousedown=!1,b.parent.off(b.canTouch?"touchmove":"mousemove",a.proxy(c,b)),b.canTouch||b.parent.off("mouseleave",a.proxy(d,b)),b.parent.off(b.canTouch?"touchend":"mouseup",a.proxy(e,b)),b.moved?void 0:b.toggle(f)},f=function(f){b.zoomed&&(f.stopPropagation(),f.preventDefault()),b.mousedown=!0;var g=b._getEvent(f);b.pos.start={x:g.pageX,y:g.pageY},setTimeout(function(){b.parent.on(b.canTouch?"touchmove":"mousemove",a.proxy(c,b)),b.parent.on(b.canTouch?"touchend":"mouseup",a.proxy(e,b))},1),b.canTouch||b.parent.on("mouseleave",a.proxy(d,b)),b.moved=!1;f.timeStamp;return b.startTouchEvent=f,!0};b.parent.on(b.canTouch?"touchstart":"mousedown",a.proxy(f,b))};if(this.canTouch){if("disable"==this.options.activate.touch)return!1;if("doubleTap"==this.options.activate.touch){var d=300,e=20;this._lastEvent="";var f=function(c){b.parent.on("touchend touchcancel",a.proxy(g,b)),this.startTouchEvent=c;var c=this._getEvent(c);b.pos.start={x:c.pageX,y:c.pageY},c.timeStamp=(new Date).getTime();var f=c.timeStamp-(this._lastEvent&&this._lastEvent.timeStamp)||0,h=Math.abs(c.pageX-this._lastEvent.pageX)>e||Math.abs(c.pageY-this._lastEvent.pageY)>e;return d>f&&0!=f&&!h&&this.toggle(this.startTouchEvent),this._lastEvent=c,!0},g=function(c){b.pos.cur=b.pos.last,b.parent.off("touchend touchcancel",a.proxy(g,b))};b.parent.on("touchstart",a.proxy(f,b))}else if("pinch"==this.options.activate.touch){var h=2;this._scale=1,this._scaled=!1,this._cycle?(this.maxZoom=this.options.zoom[this._cycle.len-1],this._cycle=!1):this.maxZoom=this.options.zoom;var f=function(c){if(b.parent.on("touchcancel touchend",a.proxy(j,b)),c.originalEvent&&c.originalEvent.touches&&c.originalEvent.touches[0]){if(1==c.originalEvent.touches.length){var d=b._getEvent(c);return b.pos.start={x:d.pageX,y:d.pageY},!0}if(c.originalEvent.touches.length!=h)return!0}return c.preventDefault(),c.stopPropagation(),this.startZoom=this.zoomBy,this.startPos=this.pos.last,this.pos.start=this._getPosition(c.originalEvent.touches),this.pinching=!0,this.hasPinchEnded=!1,this._scaled||(this.o=this._pinchZoomStart(c)),this._startDist=this._getDistance(c.originalEvent.touches),this._scale=this._lastScale||this._scale,this.parent.on("touchmove",a.proxy(i,this)),this.parent.on("touchcancel touchend",a.proxy(g,this)),!0},i=function(a){if(a.originalEvent&&a.originalEvent.touches&&a.originalEvent.touches[0]&&a.originalEvent.touches.length!=h)return!0;var b=this._getDistance(a.originalEvent.touches),c=this._getPosition(a.originalEvent.touches),d=b/this._startDist;d=Math.max(1,Math.min(d*this._scale,this.maxZoom)),this._pinchZoom(a,d,c,this.o),this._lastScale=d,this._scaled=!0},j=function(c){b.pos.cur=b.pos.last,b.parent.off("touchcancel touchend",a.proxy(j,b))},g=function(c){c.originalEvent&&c.originalEvent.touches&&0==c.originalEvent.touches.length&&(b.hasPinchEnded=!0),b.parent.off("touchmove",a.proxy(i,this)),b.hasPinchEnded&&(1==this.zoomBy&&(this.zoomed=!1),b.pinching=!1,b.pos.cur=b.pos.last,b.parent.off("touchcancel touchend",a.proxy(g,this)))};b.parent.on("touchstart",a.proxy(f,b))}else"none"==this.options.activate.touch||c()}else{if("disable"==this.options.activate.mouse)return!1;if("over"==this.options.activate.mouse||"over-noclick"==this.options.activate.mouse){var k="mouseenter mousedown";"over-noclick"==this.options.activate.mouse&&(k="mouseenter"),b.parent.on(k,function(a){return"mouseenter"!=a.type||b.zoomed?"mousedown"==a.type?b.toggle(a):void 0:b.toggle(a)}),b.parent.on("mouseleave",function(a){return b.zoom(!1,a)})}else"down"==this.options.activate.mouse?(this.options.pan=!1,b.parent.on("mousedown",function(a){b.toggle(a)})):"none"==this.options.activate.mouse||c()}("created"==this.options.preload.zoomed||this.canTouch&&"pinch"==this.options.activate.touch||this._loadZoomedPromise)&&this.preload(),this._track("created")}},zoomed:!1,toggle:function(a,b){this._cycle?this.cycle(a,b):this.zoom(!this.zoomed,a)},cycle:function(b,c){this.animating||(void 0!==c?this._cycle.current=c:this._cycle.current=this._cycle.current+=1,this.options.zoom[this._cycle.current]?(this.map&&this.inner.off("mousemove touchmove",a.proxy(this._mapMove,this)),this.parent.off("mousemove touchmove"),this.oldTarget=this.target[0]==this.imgs[this._cycle.current][0]?null:this.target,this.oldZoom=this.options.zoom[this._cycle.current],this.target=this.imgs[this._cycle.current],this.zoom(!0,b),this.pos.cur=this.pos.last):(this._cycle.current=-1,this.zoom(!1,b)))},zoom:function(c,d,e){if(c!=this.zoomed||this._cycle||e){this.zoomed=c;var f=this;if(c){if(this.box&&this.box.show(),!this._zoomLoaded)return void this._checkLoaded(d);this.init=!1,this.moveEvent=this.canTouch?"touchmove":"mousemove",this.zoomBy=this._cycle?this.options.zoom[this._cycle.current]||1:this.options.zoom;var g=this.overflow.width(),h=this.overflow.height(),i=g*this.zoomBy,j=h*this.zoomBy,k=this.parent.offset(),l=0,m=0,n=0,o=0,p=0;void 0===d&&(d={pageX:g/2,pageY:h/2}),this._track("startMove",{domEvent:d,zoom:this.zoomBy}),this.parent.removeClass(this.options.states.inactive).addClass(this.options.states.active),this.wrapper.css({width:i,height:j}),this[this.mark.name]&&(this.box&&(l=this.box.width(),m=this.box.height(),this.lens&&(p=this._makeLens(this.lens,l,m,this.zoomBy,{w:g,h:h}))),this.map&&(n=this.map.width(),o=n*(this.element.height()/this.element.width()),this.inner.height(o),this.inner.width(n),this.lens&&(p=this._makeLens(this.lens,n,o,this.zoomBy,{w:n,h:o})),this._mapEnd=function(b){f.mousedownForMap=!1,f.inner.off(f.canTouch?"touchmove":"mousemove",a.proxy(f._mapMove,f)),f.inner.off(f.canTouch?"touchend":"mouseup",a.proxy(f._mapEnd,f))},this._mapMove=function(a){f.mousedownForMap&&f._mouseMove(f._getEvent(a),g,h,i,j,f.map.offset(),l,m,n,o,p,!0)},this._mapStart=function(b){b.preventDefault(),b.stopPropagation(),f.mousedownForMap=!0,f._mouseMove(f._getEvent(b),g,h,i,j,f.map.offset(),l,m,n,o,p,!0),this.inner.on(f.canTouch?"touchmove":"mousemove",a.proxy(f._mapMove,f)),this.inner.on(f.canTouch?"touchend":"mouseup",a.proxy(f._mapEnd,f))},this.inner.on("mouseleave",a.proxy(f._mapEnd,f)),this.inner.on(f.canTouch?"touchstart":"mousedown",a.proxy(this._mapStart,f))),this[this.mark.name].show(),this[this.mark.inner].show(),this[this.mark.inner].removeClass(this.options.states.inactive).addClass(this.options.states.active)),this._parentMove=function(a){a.preventDefault(),a.stopPropagation(),f._mouseMove(f._getEvent(a),g,h,i,j,k,l,m,n,o,p)},this.parent.on(this.moveEvent,a.proxy(f._parentMove,f)),this._mouseMove(f._getEvent(d),g,h,i,j,k,l,m,n,o,p),this._setZoomCursor(f.lens?f.lens:f.parent),this.options.fade?(this.animating=!0,this.target.animate({opacity:1},{complete:function(){f.canHideEl&&f.element.css({opacity:1}),f.animating=!1,f.oldTarget&&f.oldTarget.css(b)}})):(this.target.css({opacity:1}),f.canHideEl&&this.element.css({opacity:1}),f.oldTarget&&f.oldTarget.css(b)),this.lens&&this.lens.show(),this._track("zoomedIn",{domEvent:d,zoom:this.zoomBy})}else this.init=!1,this._track("stopMove",{domEvent:d}),this.pos={start:{x:0,y:0},last:{x:0,y:0},cur:{x:0,y:0}},this.target.css(b),clearInterval(f.interval),this.options.fade&&this.target.stop(),this[this.mark.name]&&(this[this.mark.name].hide(),this[this.mark.inner].hide(),this[this.mark.inner].removeClass(this.options.states.active).addClass(this.options.states.inactive),this.map&&(this.inner.off("mouseleave",a.proxy(f._mapEnd,f)),this.inner.off(f.canTouch?"touchstart":"mousedown",a.proxy(this._mapStart,f)))),this.canHideEl&&this.element.css({opacity:1}),this._cycle&&(this._cycle.current=-1),this.lens&&this.lens.hide(),this.moveEvent&&a.proxy(this._parentMove,this)&&this.parent.off(this.moveEvent,a.proxy(this._parentMove,this)),this.wrapper.css({width:"",height:""}),this._setCursor(this.options.cursor.inactive,this.parent),this.parent.removeClass(this.options.states.active).addClass(this.options.states.inactive),this._track("zoomedOut",d)}},_getEvent:function(a){return a&&"touchend"==a.type&&(a=this.startTouchEvent),a&&a.originalEvent&&a.originalEvent.touches&&a.originalEvent.touches[0]&&(a=a.originalEvent.touches[0]),a},load:function(a){this._loadImage()},visible:function(a){if(this._visible==a){if(a==this._zoomVisible)return;return void(a&&"visible"==this.options.preload.zoomed&&(this._loadZoomed(),this._zoomVisible=a))}a&&this._track("visible",{visible:a}),a?("visible"==this.options.preload.image&&this._loadImage(),"visible"==this.options.preload.zoomed&&(this._loadZoomed(),this._zoomVisible=a),this._calcSize()):this.zoom(!1),this._visible=a},preload:function(){this._loadZoomed()},_makeLens:function(a,b,c,d,e){var f={lw:b/d,lh:c/d,lwh:0,lhh:0,dl:0,dt:0};return a.width(f.lw),a.height(f.lh),f.dl=a.outerWidth(!0)-f.lw,f.dt=a.outerHeight(!0)-f.lh,f.lw+f.dl>e.w&&(f.lw=e.w-f.dl),f.lh+f.dt>e.h&&(f.lh=e.h-f.dt),a.width(f.lw),a.height(f.lh),f.lwh=f.lw/2,f.lhh=f.lh/2,f.dlh=f.dl/2,f.dth=f.dt/2,f},_loadZoomed:function(){if(!this._imageLoaded)return"none"!=this.options.preload.zoomed&&(this._loadZoomedPromise=!0),void this._loadImage();if(!this._zoomLoaded&&!this._zoomLoading){var b=this;this._zoomLoading=!0,this._zoomLoaded=!1,this._toLoadCount=this.imgs.length,this._zoomLoadedCount=0,this._track("startPreload");var c=function(a){b._zoomLoadedCount++,b._zoomLoadedCount==b._toLoadCount&&(b._zoomLoaded=!0,b._zoomLoading=!1,b.loading.hide(),b._track("preloaded"),b._calcSize())};a.each(this.imgs,function(a,d){d.on("load",c),d[0].src=b._getUrl(b.options.zoom[a])})}},_checkLoaded:function(a){var b=this,c=!1;this._zoomLoading||this._loadZoomed(),clearInterval(this.interval),this.interval=setInterval(function(){b._zoomLoaded?(clearInterval(b.interval),b.zoom(b.zoomed,a,!0)):b._zoomLoading&&!c&&(b.canHideEl&&b.element.css({opacity:0}),c=!0)},50)},_pinchZoomStart:function(b){var c=this;this.zoomed=!0,this.options.fade?this.target.animate({opacity:1}):this.target.css({opacity:1}),this.target.show();var d={pw:this.overflow.width(),ph:this.overflow.height(),po:this.parent.offset(),mw:0,mh:0,lens:null};return d.tw=1*d.pw,d.th=1*d.ph,this.wrapper.css({width:this.overflow.width(),height:this.overflow.height()}),this.map&&(d.mw=this.map.width(),d.mh=d.mw*(this.element.height()/this.element.width()),d.mo=this.map.offset(),this.inner.height(d.mh),this.map.show(),this.lens&&(d.lens=this._makeLens(this.lens,d.mw,d.mh,1,{w:d.mw,h:d.mh})),this._mapEnd=function(b){c.inner.off("touchmove",a.proxy(c._mapMove,c)),c.inner.off("touchend",a.proxy(c._mapEnd,c))},this._mapMove=function(a){a.preventDefault(),a.stopPropagation(),c._mouseMove(c._getEvent(a),d.pw,d.ph,d.tw,d.th,c.map.offset(),null,null,d.mw,d.mh,d.lens,!0)},this._mapStart=function(b){b.preventDefault(),b.stopPropagation(),c._mouseMove(c._getEvent(b),d.pw,d.ph,d.tw,d.th,c.map.offset(),null,null,d.mw,d.mh,d.lens,!0),this.inner.on("touchmove",a.proxy(c._mapMove,c)),this.inner.on("touchend",a.proxy(c._mapEnd,c))},this.inner.on("touchstart",a.proxy(this._mapStart,this)),this.inner.removeClass(this.options.states.inactive).addClass(this.options.states.active),this.inner.show(),this.lens&&this.lens.show()),this._parentMove=function(a){return c.hasPinchEnded?a.originalEvent&&a.originalEvent.touches&&a.originalEvent.touches[0]&&1!=a.originalEvent.touches.length?!0:(a.preventDefault(),1!==this.zoomBy&&a.stopPropagation(),void c._mouseMove(c._getEvent(a),d.pw,d.ph,d.tw,d.th,d.po,null,null,d.mw,d.mh,d.lens)):(a.stopPropagation(),!0)},this.parent.on("touchmove",a.proxy(this._parentMove,this)),d},_pinchZoom:function(a,b,c,d){b==this.maxZoom?this._track("maxZoom",{domEvent:a,scale:b,center:c}):1==b&&this._track("minZoom",{domEvent:a,scale:b,center:c}),d.tw=d.pw*b,d.th=d.ph*b,this.zoomBy=b,this.wrapper.css({width:d.tw,height:d.th}),this.lens&&(d.lens=this._makeLens(this.lens,d.mw,d.mh,b,{w:d.mw,h:d.mh})),this._mouseMove({currentTarget:a.currentTarget,pageX:c.x,pageY:c.y},d.pw,d.ph,d.tw,d.th,d.po,null,null,d.mw,d.mh,d.lens)},_mouseMove:function(a,b,c,d,e,f,g,h,i,j,k,l){var m,n,o,p,q,r=g?d-b+(b-g):d-b,s=h?e-c+(c-h):e-c;if(this.init&&this.options.pan){if(!(this.mousedown||this.canTouch||l))return void(this.panning=!1);if(this.pinching)m=(this.startPos.x+(this.pos.start.x-f.left))/this.startZoom,n=(this.startPos.y+(this.pos.start.y-f.top))/this.startZoom,o=r*(m/b),p=s*(n/c);else{this.panning=!0;var t=this.pos.start.x-a.pageX,u=this.pos.start.y-a.pageY;o=t+this.pos.cur.x,p=u+this.pos.cur.y,m=(o+b/2)/(d/b),n=(p+c/2)/(e/c)}}else this.init=!0,this.panning=!1,m=a.pageX-f.left,n=a.pageY-f.top,o=r*(m/b),p=s*(n/c),this.pos.cur.x=this.pos.last.x||o,this.pos.cur.y=this.pos.last.y||p;if(this.lens){if(this.box){this.box[0].lastChild.relatedUUID!=this.uuid&&(this.box.append(this.wrapper),this.wrapper.show().siblings().hide());var v=b,w=c,x=m-k.lwh-k.dlh,y=n-k.lhh-k.dth;o=(x+k.dlh)*this.zoomBy-k.lw/b,p=(y+k.dth)*this.zoomBy-k.lh/c,q=this._setBounds(m,n,b,c,0,0),m=q.x,n=q.y}else if(l){this.panning&&(m=a.pageX-f.left,n=a.pageY-f.top);var v=i,w=j,x=m-k.lwh-k.dlh,y=n-k.lhh-k.dth;o=((x+k.dlh)*this.zoomBy-k.lw/b)*b/i,p=((y+k.dth)*this.zoomBy-k.lh/c)*c/j,this.pos.cur={x:o,y:p}}else if(this.map){if(this.map[0].lastChild.relatedUUID!=this.uuid&&(this.map.append(this.inner),this.inner.show().siblings().hide()),this.panning){var x=m/(b/i)-k.lwh-k.dth;y=n/(c/j)-k.lhh-k.dth}else var z=m/(b/k.lw),A=n/(c/k.lh),x=m/(b/i)-z-k.dlh,y=n/(c/j)-A-k.dth;q=this._setBounds(x,y,i-k.lw-k.dl,j-k.lh-k.dt,0,0),x=q.x,y=q.y}(this.box||l)&&(m+k.lwh+k.dlh>=v&&(x=v-k.lw-k.dl),n+k.lhh+k.dth>=w&&(y=w-k.lh-k.dt),m-k.lwh-k.dlh<=0&&(x=0),n-k.lhh-k.dth<=0&&(y=0)),this.lens.css({top:y+"px",left:x+"px"})}q=this._setBounds(o,p,r,s,0,0),o=q.x,p=q.y,this.pos.last={x:o,y:p},this.lastPos={x:o,y:p},this.oldTarget&&this.oldTarget.css({top:-p+"px",left:-o+"px"}),this.target.css({top:-p+"px",left:-o+"px"}),this._track("move",{domEvent:a,pos:{x:m/b,y:n/c}})},_calcSize:function(){var a,b;if(this.options.responsive&&this.options.width&&this.options.height&&"auto"!=this.options.width&&"auto"!=this.options.height?(a=this.element.width(),b=a*(this.options.height/this.options.width),this.parent.height(b),this.overflow.height(b),0!=this.element.height()&&b>this.element.height()&&this.overflow.height(this.element.height())):(this.options.width&&this.parent.width(this.options.width),this.options.height&&this.parent.height(this.options.height)),this.map){var c=this.map.width(),d=c*(this.element.height()/this.element.width());this.inner.height(d)}},_getUrl:function(b){if(this.options.url)return this.options.url;var c=this.element.attr("src")||this.element.attr("data-amp-src");if(c){var d=this._cycle?b||1:this.options.zoom;c=this._cleanUrl(c);var e=this.options.transforms;if(this._cycle){var f=a.inArray(b,this.options.zoom);e=e[f]}return c=e?this._setTransforms(c,e):c,c=this._setWidth(c,{h:this._originalImage.height*d,w:this._originalImage.width*d})}},_getWidth:function(a){if(window.amp&&amp.di)return amp.di.width(a);var a=a.split("?");if(!a[1])return!1;for(var b=a[1].split("&"),c=0;c<b.length;c++){var d=b[c].split("=");if("w"==d[0])return parseInt(d[1])}return!1},_setWidth:function(b,c){if(window.amp&&amp.di)return amp.di.set(b,c);var b=b.split("?");if(b[1]){for(var d=b[1].split("&"),e=[],f=0;f<d.length;f++){var g=d[f].split("="),h={};"w"!=g[0]&&(h[g[0]]=g[1],e.push(a.param(h)))}return e=e.concat(a.param(c)),b[0]+"?"+e.join("&")}return b[0]+"?"+a.param(c)},_cleanUrl:function(a){var b=a.split("?");return b[0]},_loadImage:function(){if(!this._imageLoaded&&!this._imageLoading){this.loading=a('<div class="amp-loading"></div>'),this._imageLoading=!0;var b=this.element[0].src||this.element.attr("data-amp-src");this.element.on("load",a.proxy(this._onImageLoad,this)),this.element[0].src="",this.element[0].src=b}},_getNaturalSize:function(a){return{width:this.element[0].naturalWidth,height:this.element[0].naturalHeight}},_setTransforms:function(a,b){return-1==a.indexOf("?")?a+"?"+b:a+"&"+b},_setBounds:function(a,b,c,d,e,f){return a>=c&&(a=c),b>=d&&(b=d),e>=a&&(a=e),f>=b&&(b=f),{x:a,y:b}},_track:function(a,b){this._trigger(a,null,b),window.amp&&amp.stats&&amp.stats.event&&amp.stats.event(this.element,"zoom",a,b)},_setCursor:function(a,b){return"string"!=typeof a&&(a="auto"),a.indexOf("zoom")<0?(b.css("cursor",a),!1):document.documentMode?!1:("undefined"!=typeof InstallTrigger&&b.css("cursor","-moz-"+a),void(window.chrome&&b.css("cursor","-webkit-"+a)))},_setZoomCursor:function(a){var b=this.options.zoom;if(b.length){var c=b.indexOf(this.zoomBy);c===b.length-1?this._setCursor(this.options.cursor.active,a):this._setCursor(this.options.cursor.inactive,a)}else this.zoomBy>1?this._setCursor(this.options.cursor.active,a):this._setCursor(this.options.cursor.inactive,a)},_getDistance:function(a){var b=Math.abs(a[0].pageX-a[1].pageX),c=Math.abs(a[0].pageY-a[1].pageY);return Math.sqrt(b*b+c*c)},_getPosition:function(a){return{x:(a[0].pageX+a[1].pageX)/2,y:(a[0].pageY+a[1].pageY)/2}},_destroy:function(){this.element.unwrap().unwrap(),this.wrapper.remove(),this.element.removeClass("amp"),this.element.removeClass("amp-zoom"),this.element.removeClass(this.options.states.active),this.element.removeClass(this.options.states.inactive),this.element.css({cursor:"",height:"","max-width":"",width:"",opacity:"",position:"",display:"",top:"",left:"",zoom:""}),this._removeEmptyAttributeHelper(this.element)},_removeEmptyAttributeHelper:function(a,b){for(var c=b||["class","style"],d=0,e=c.length;e>d;d++)a.attr(c[d])&&a.prop(c[d])||a.removeAttr(c[d])}})}(jQuery),function(a){a.widget("amp.ampZoomInline",{options:{scaleMax:3,scaleStep:.5,scaleSteps:!1,events:{zoomIn:"mouseup touchstart",zoomOut:"mouseup touchend",move:"mousemove touchmove"},stopPropagation:"",activation:{inGesture:!0},pinch:!1,transforms:"",preload:"none",pan:!1},_getCreateOptions:function(){var b=this.element.data().ampZoomInline;return b?a.extend(!0,{},this.options,b):this.options},_create:function(){this.scale=1,this.element.addClass("amp amp-zoom"),this.$parent=this.element.parent(),this._invalidateParentSize(),this.element.on(this.options.events.zoomIn,a.proxy(this.zoomIn,this)),this.options.activation.inGesture||(this.gestureDetect=new b(this.element)),this._track("created"),"created"==this.options.preload&&this.load(),this.options.pan&&(a(document).on("dragstart",function(){return!1}),this.element.parent().on("mousedown touchstart",a.proxy(function(b){return this.scale>1&&b.stopPropagation(),this.panner&&(this.panner.remove(),delete this.panner),this.scale>1&&(this.panner=new d(this,b,a.proxy(function(a,b){this.zoomArea&&this.zoomArea.setPosition(a,b)},this))),!0},this))),this.options.pinch&&this.element.parent().on("touchstart",a.proxy(function(b){return this.pincher&&(this.pincher.remove(),delete this.pincher),this.pincher=new c(b,a.proxy(function(){this.zoomIn()},this),a.proxy(function(){this.zoomOut()},this)),!0},this)),""!==this.options.stopPropagation&&this.element.parent().on(this.options.stopPropagation,a.proxy(function(a){1!=this.scale&&a.stopPropagation()},this))},visible:function(a){this._visible!=a&&(a&&this._track("visible",{visible:a}),a?"visible"==this.options.preload&&this.load():this.zoomOutFull(),this._visible=a)},load:function(){this._setupZoomArea().then(a.proxy(function(a){a.setScale(this.options.zoom)},this))},_setupZoomArea:function(){return new Promise(a.proxy(function(b,c){this.zoomArea?b(this.zoomArea):this.getImageSize().then(a.proxy(function(a){a.error?c(!1):(this.zoomArea=new e(this.element,this.$parent,a,this.options.transforms),b(this.zoomArea))},this))},this))},getImageSize:function(){return new Promise(a.proxy(function(b,c){this.element[0].naturalWidth&&this.element[0].naturalHeight?b({x:this.element[0].naturalWidth,y:this.element[0].naturalHeight}):this.element[0].width&&this.element[0].height&&b({x:this.element[0].width,y:this.element[0].height}),this.element.on("load",a.proxy(function(){this.element[0].naturalWidth&&this.element[0].naturalHeight?b({x:this.element[0].naturalWidth,y:this.element[0].naturalHeight}):this.element[0].width&&this.element[0].height&&b({x:this.element[0].width,y:this.element[0].height})},this)),this.element.on("error",a.proxy(function(){c({error:!0})},this))},this))},_invalidateParentSize:function(){this.parentSize={x:this.$parent.width(),y:this.$parent.height()}},state:function(){return{scale:this.scale,scaleMax:this.options.scaleMax,scaleStep:this.options.scaleStep}},zoomInFull:function(a){this.setScale(this.options.scaleMax),this._track("zoomedInFull",{domEvent:a,scale:this.options.scaleMax,scaleMax:this.options.scaleMax,scaleStep:this.options.scaleStep})},zoomIn:function(b){if((this.options.scaleSteps||1==this.scale)&&(b&&b.preventDefault(),this.options.activation.inGesture||!this.gestureDetect.detected)){var c=this.scale;this.options.scaleSteps?(this.scale+=this.options.scaleStep,this.scale=Math.min(this.scale,this.options.scaleMax)):this.scale=this.options.scaleMax,c!=this.scale&&(this._track("zoomedIn",{domEvent:b,scale:this.scale,scaleMax:this.options.scaleMax,scaleStep:this.options.scaleStep}),this.setScale(this.scale),setTimeout(a.proxy(function(){a(document).on(this.options.events.move,a.proxy(this._setPos,this)),this.options.scaleSteps||a(document).on(this.options.events.zoomOut,a.proxy(this.zoomOut,this))},this),1))}},zoomInClick:function(b){if(this.options.activation.inGesture||!this.gestureDetect.detected){var c=this.scale;this.scale+=this.options.scaleStep,this.scale=Math.min(this.scale,this.options.scaleMax),c!=this.scale&&(this._track("zoomedIn",{domEvent:b,scale:this.scale,scaleMax:this.options.scaleMax,scaleStep:this.options.scaleStep}),this.setScale(this.scale),setTimeout(a.proxy(function(){a(document).on(this.options.events.move,a.proxy(this._setPos,this))},this),1))}},setScale:function(b){this.scale=b,this._setupZoomArea().then(a.proxy(function(a){a&&(a.setScale(this.scale),this._invalidateParentSize())},this))},_setPos:function(a){this._track("settingPos",{domEvent:a});var b=a?this._getPercentagePos(a):{x:.5,y:.5};this.zoomArea.setPosition(b.x,b.y)},zoomOut:function(b){var c=this.scale;this.options.scaleSteps?(this.scale-=this.options.scaleStep,this.scale=Math.max(this.scale,1)):this.scale=1,c!=this.scale&&(1==this.scale&&(this.options.events.move&&a(document).off(this.options.events.move,this._setPos),this.options.events.zoomOut&&a(document).off(this.options.events.zoomOut,this.zoomOut)),this.zoomArea.setScale(this.scale),this._track("zoomedOut",{domEvent:b,scale:this.scale,scaleMax:this.options.scaleMax,scaleStep:this.options.scaleStep}))},zoomOutFull:function(b){this.zoomArea&&(this.options.events.move&&a(document).off(this.options.events.move,this._setPos),this.options.events.zoomOut&&a(document).off(this.options.events.zoomOut,this.zoomOut),this.scale=1,this.zoomArea.setScale(1),this._track("zoomedOutFull",{domEvent:b,scale:this.scale,scaleMax:this.options.scaleMax,scaleStep:this.options.scaleStep}))},_convertEvent:function(a){return a.originalEvent&&a.originalEvent.touches&&a.originalEvent.touches[0]&&(a.preventDefault(),a=a.originalEvent.touches[0]),a},_getPercentagePos:function(a){a=this._convertEvent(a);var b=this.$parent.offset();return{x:(a.pageX-b.left)/this.parentSize.x,y:(a.pageY-b.top)/this.parentSize.y}},_track:function(a,b){this._trigger(a,null,b),window.amp&&amp.stats&&amp.stats.event&&amp.stats.event(this.element,"zoom",a,b)},_destroy:function(){this.element.removeClass("amp"),this.element.removeClass("amp-zoom"),this._removeEmptyAttributeHelper(this.element)},_removeEmptyAttributeHelper:function(a,b){for(var c=b||["class","style"],d=0,e=c.length;e>d;d++)a.attr(c[d])&&a.prop(c[d])||a.removeAttr(c[d])}});var b=function(b,c){this.toleranceX=void 0!==b?b:0,this.toleranceY=void 0!==c?c:0,this.detected=!1,this.$document=a("body"),this.$document.on("mousedown touchstart",a.proxy(this.startDetecting,this))};b.prototype.convertEvent=function(a){return a.originalEvent&&a.originalEvent.touches&&a.originalEvent.touches[0]&&(a=a.originalEvent.touches[0]),a},b.prototype.startDetecting=function(b){this.detected=!1,this.$document.on("mousemove touchmove",a.proxy(this.moveDetected,this)),this.$document.on("mouseup touchend",a.proxy(this.stopDetecting,this))},b.prototype.moveDetected=function(a){this.detected=!0},b.prototype.stopDetecting=function(a){this.$document.off("mousemove touchmove",this.moveDetected),this.$document.off("mouseup touchend",this.stopDetecting)};var c=function(b,c,d){this.threshold=100,b=this.getFingers(b),this.cbIn=c,this.cbOut=d,2==b.length&&(this.start=this.getDistance(b),a(document).on("touchmove",a.proxy(this.move,this)),a(document).on("touchend",a.proxy(this.end,this)))};c.prototype.getDistance=function(a){var b=Math.abs(a[0].pageX-a[1].pageX),c=Math.abs(a[0].pageY-a[1].pageY);return Math.sqrt(b*b+c*c)},c.prototype.move=function(a){a.preventDefault(),a=this.getFingers(a);var b=this.getDistance(a),c=b-this.start;c>this.threshold&&(this.cbIn(),this.start=b),c<0-this.threshold&&(this.cbOut(),this.start=b)},c.prototype.remove=function(){this.end()},c.prototype.end=function(b){a(document).off("mousemove touchmove",this.move),a(document).off("mouseup touchend",this.end)},c.prototype.getFingers=function(a){return a.originalEvent&&a.originalEvent.touches&&(a=a.originalEvent.touches),a};var d=function(b,c,d){this.multiFinger(c)||(c=this.convertEvent(c),this.start={x:c.pageX,y:c.pageY},this.zoomArea=b.zoomArea,this.cb=d,this.element=b.element,this.currentPixPos=this.zoomArea.getPixPos(),a(document).on("mousemove touchmove",a.proxy(this.move,this)),a(document).on("mouseup touchend",a.proxy(this.end,this)))};d.prototype.move=function(a){a.preventDefault(),a=this.convertEvent(a);var b=a.pageX-this.start.x,c=a.pageY-this.start.y,d=this.zoomArea.getPercentFromPos(this.currentPixPos.x+b,this.currentPixPos.y+c);this.cb(d.x,d.y)},d.prototype.end=function(b){a(document).off("mousemove touchmove",this.move),a(document).off("mouseup touchend",this.end)},d.prototype.remove=function(){this.end()},d.prototype.multiFinger=function(a){return a.originalEvent&&a.originalEvent.touches&&a.originalEvent.touches.length>1},d.prototype.convertEvent=function(a){return a.originalEvent&&a.originalEvent.touches&&a.originalEvent.touches[0]&&(a=a.originalEvent.touches[0]),a};var e=function(a,b,c,d){this.animating=!1,this.transforms=d,this.initialSrc=a.attr("src"),this.scale=1,this.$area=b,this.$source=a,this.originalSize=c,this.posPercentageX=.5,this.posPercentageY=.5,this.createContainer(),this.hide()};e.prototype.getPercentagePosWithScale=function(a){},e.prototype.createContainer=function(){this.$container=a('<div class="amp-zoomed-container"></div>'),this.$preloader=a('<img style="display:none">'),this.$preloader.on("load",a.proxy(this.setImage,this)),this.$zoomed=a('<img class="amp-zoomed" src=""/>'),this.$container.append(this.$zoomed),this.$container.append(this.$preloader),this.$area.append(this.$container),this.$container.css({position:"absolute",top:0,left:0,bottom:0,right:0})},e.prototype.invalidatePosition=function(){this.setPosition(this.posPercentageX,this.posPercentageY)},e.prototype.setPosition=function(a,b){this.animating||(this.$zoomed.width()<=this.$area.width()&&(a=.5),this.$zoomed.height()<=this.$area.height()&&(b=.5),this.posPercentageX=a,this.posPercentageY=b,a=Math.min(1,Math.max(0,a)),b=Math.min(1,Math.max(0,b)),this.$zoomed.css("left",0-(this.$zoomed.width()-this.$area.width())*a+"px"),this.$zoomed.css("top",0-(this.$zoomed.height()-this.$area.height())*b+"px"))},e.prototype.getPixPos=function(a,b){return void 0==a&&void 0==b&&(a=this.posPercentageX,b=this.posPercentageY),a=Math.min(1,Math.max(0,a)),b=Math.min(1,Math.max(0,b)),{x:0-(this.newSize.x-this.$area.width())*a,y:0-(this.newSize.y-this.$area.height())*b}},e.prototype.getPercentFromPos=function(a,b){var c=0-a/(this.newSize.x-this.$area.width()),d=0-b/(this.newSize.y-this.$area.height());return{x:c,y:d}},e.prototype.animate=function(b,c,d){this.animating=!0,b.x<=this.$area.width()&&(c.x=this.getPixPos(.5,.5).x),b.y<=this.$area.height()&&(c.y=this.getPixPos(.5,.5).y),this.$zoomed.animate({width:b.x,height:b.y,left:c.x+"px",top:c.y+"px"},500,a.proxy(function(){this.animating=!1,d&&d()},this))},e.prototype.setScale=function(b,c){b!=this.scale&&(b<this.scale&&1==b?this.newSize={x:this.$source.width(),y:this.$source.height()}:this.newSize={x:this.$source.width()*b,y:this.$source.height()*b},1==this.scale&&(this.$zoomed.attr("src",this.$source.attr("src")),b>this.scale&&(this.$zoomed.width(this.$source.width()),this.$zoomed.height(this.$source.height())),this.setPosition(.5,.5),this.show()),1==b?this.animate(this.newSize,this.getPixPos(),a.proxy(this.hide,this)):this.animate(this.newSize,this.getPixPos()),this.scale=b,this.invalidateImageURL({x:this.originalSize.x*b,y:this.originalSize.y*b}))},e.prototype.show=function(){this.invalidatePosition(),a(window).off("resize",this.invalidatePosition),a(window).on("resize",a.proxy(this.invalidatePosition,this)),this.$container.show()},e.prototype.hide=function(){this.$container.hide(),a(window).off("resize",this.invalidatePosition)},e.prototype.invalidateImageURL=function(a){var b="";this.transforms&&this.transforms.length&&(b=this.transforms+"&");var c=this.initialSrc.split("?")[0]+"?"+b+"w="+a.x+"&h="+a.y;(0==a.x||0==a.y)&&(c=""),this.$preloader.attr("src",c)},e.prototype.setImage=function(){this.$zoomed.attr("src",this.$preloader.attr("src"))}}(jQuery),function(a){a.widget("amp.ampVideo",{options:{autoplay:!1,loop:!1,muted:!1,
skin:"amp-video-skin",responsive:!0,preload:"auto",pauseOnHide:!0,controls:!0,nativeControlsForTouch:!0,plugins:{},enableSoftStates:!0},_states:{stopped:0,buffering:1,paused:2,playing:3,loading:4,error:5,idle:6},_currentState:0,_ready:!1,_loopCount:0,_savedHTML:"",_getCreateOptions:function(){this._savedHTML=this.element[0].outerHTML;var b=this.element.data().ampVideo;return b?a.extend(!0,{},this.options,b):this.options},_create:function(){this.element.addClass("amp amp-video");var b=this.element.find("video"),c=this;b.addClass("video-js "+this.options.skin),videojs&&(videojs.options.flash.swf=this.options.swfUrl+"video-js.swf"||"../../assets/video-js.swf",this._player=videojs(b[0],{autoplay:this.options.autoplay,muted:this.options.muted,width:"100%",height:"100%",loop:!1,controls:this.options.controls,preload:this.options.preload,plugins:c._sanitisePlugins(this.options.plugins),nativeControlsForTouch:this.options.nativeControlsForTouch})),c._calcSize(),c.options.responsive&&a(window).bind("resize",function(a){return function(){return a._calcSize()}}(c)),this._player.ready(function(){c._ready=!0;var b=c.element.find(".vjs-tech"),d=setInterval(function(){if("auto"==c.options.height){var a=b.css({height:"auto"}).height();0!=a&&(clearInterval(d),c.element.height(a),b.css({height:""}),c._player.dimensions(c.element.width(),c.element.height()))}},200);c.options.autoplay&&c.state(c._states.playing),this.on("play",function(a){c.softPlay&&c.options.enableSoftStates?c.softPlay=!1:(c.state(c._states.playing),c._track("play",{event:a,player:this,time:this.currentTime(),duration:c.duration}))}),this.on("error",function(a){c.state(c._states.error),c._track("error",null)}),this.on("pause",function(a){a.target.ended||a.target.seeking||(c.state(c._states.paused),c._track("pause",{event:a,player:this,time:this.currentTime(),duration:c.duration}))}),this.on("waiting",function(a){c.state(c._states.buffering)}),this.on("seeking",function(a){c.softSeek?c.softSeek=!1:(c.state()!==c._states.paused&&0!==a.target.currentTime&&c.options.enableSoftStates&&(c.softPlay=!0),c._track("seeked",{event:a,player:this,time:this.currentTime(),duration:c.duration}))}),this.on("timeupdate",function(a){c._track("timeUpdate",{event:a,player:this,time:this.currentTime(),duration:c.duration})}),this.on("volumechange",function(a){c._track("volume",{event:a,player:this,volume:this.volume(),muted:this.muted()})}),this.on("durationchange",function(a){c.duration=this.duration(),c._track("durationChange",{event:a,player:this,duration:c.duration})}),this.on("fullscreenchange",function(b){c._track("fullScreenChange",{event:b,player:this}),setTimeout(function(){a(window).resize()},200)}),this.on("ended",function(a){c.options.loop?(c.softSeek=!0,c._player.currentTime(0),c.softPlay=!0,c._player.play(),c._track("looped",{count:++c._loopCount})):(c.state(c._states.stopped),c._track("ended",null))}),c._track("created",{player:this,duration:c.duration})})},visible:function(a){a!=this._visible&&(a?(this._track("visible",{visible:a}),this._calcSize()):(this._states.playing==this.state()||this._states.buffering==this.state())&&this.options.pauseOnHide&&this.pause(),this._visible=a)},redraw:function(){this._calcSize()},_calcSize:function(){var a,b;if(this.options.responsive&&this.options.width&&this.options.height&&"auto"!=this.options.width&&"auto"!=this.options.height){var c=this.element.css("display");this.element.css("display","block"),a=Math.round(this.element.width()),this.element.css("display",c),b=Math.round(a*(this.options.height/this.options.width)),this.element.height(b)}else this.options.width?this.element.width(this.options.width):this.options.responsive&&this.element.width(this.element.parent().width()),this.options.height?this.element.height(this.options.height):this.options.responsive&&this.element.height(this.element.parent().height());if(this.options.center){var d=this.element.height(),e=this.element.parent().height();this.element.css("margin-top",e/2-d/2+"px")}this._player&&this._player.dimensions(this.element.width(),this.element.height())},play:function(){this._ready&&this._states.playing!==this.state()&&this._player.play()},pause:function(){this._ready&&this._states.paused!==this.state()&&this._player.pause()},stop:function(){this._ready&&this._states.stopped!==this.state()&&(this._player.pause(),this.softSeek=!0,this._player.currentTime(0),this._track("stopped",null),this.state(this._states.stopped))},seek:function(a){this._ready&&this.currentTime(a)},currentTime:function(a){return void 0===a?this._player.currentTime():void this._player.currentTime(a)},state:function(a){return void 0===a?this._currentState:(this._currentState=a,void this._trigger("stateChange",null,{state:a}))},_track:function(a,b){this._trigger(a,null,b),window.amp&&amp.stats&&amp.stats.event&&amp.stats.event(this.element,"video",a,b)},_destroy:function(){this._player.dispose(),this.element[0].outerHTML=this._savedHTML},_sanitisePlugins:function(a){return a&&0==a.resolutions&&delete a.resolutions,a}})}(jQuery),function(a){a.widget("amp.ampSpin",a.amp.ampStack,{options:{delay:50,autoplay:!1,loop:!0,responsive:!0,states:{selected:"amp-selected",seen:"amp-seen",active:"amp-active",inactive:"amp-inactive"},events:{start:"mousedown touchstart",move:"mousemove touchmove",end:"mouseup touchend"},momentum:!0,preload:"created",preloadType:"full",minDistance:25,activate:"down",friction:.97,dir:"normal",gesture:{enabled:!0,fingers:1},orientation:"horz",start:1,cursor:{active:"auto",inactive:"auto"},play:{onLoad:!1,onVisible:!1,repeat:1},dragDistance:200,lazyLoad:!1},_getCreateOptions:function(){var b=this.element.data().ampSpin;return b?a.extend(!0,{},this.options,b):this.options},_create:function(){var b=this,c=this._children=this.element.children();this._count=this.element.children().length;this.$document=a(document),this.options.friction=Math.min(this.options.friction,.999),this.options.friction=Math.max(this.options.friction,0),this._setCursor(this.options.cursor.inactive),this.count=this.element.children().length,this.options.dragDistance=Math.max(this.options.dragDistance,1),this._index=Math.max(1,Math.min(this.options.start,this.count)),-1==a.inArray(this.options.preload,["created","visible","none"])&&(this.options.preload="created"),this.element.addClass("amp"),this.element.addClass("amp-spin"),this.element.addClass(this.options.states.inactive),this.imgs=this.element.find("img:not(.amp-zoom-img)"),this.toLoadCount=this.imgs.length,this.loadedCount=0,c.addClass("amp-frame"),c.css({display:"none"}),c.eq(this._index-1).css("display","block"),c.eq(this._index-1).addClass(this.options.states.selected+" "+this.options.states.seen),setTimeout(function(a){return function(){return a._calcSize()}}(b),1),this.options.responsive&&a(window).on("resize",function(a){return function(){return a._calcSize()}}(b)),this.element.on("dragstart",function(a){return!1}),this.element.on(this.options.events.start,a.proxy(this._startDrag,this)),this.element.on("mousewheel DOMMouseScroll",function(a){return b._mouseScroll(a)}),this.options.autoplay&&this.play(),"created"==this.options.preload&&this._startPreload(),this._track("created",{index:this._index,canNext:this.canNext(),canPrev:this.canPrev()})},_setCursor:function(a){return a.indexOf("zoom")<0&&a.indexOf("grab")<0?(this.element.css("cursor",a),!1):document.documentMode?!1:("undefined"!=typeof InstallTrigger&&this.element.css("cursor","-moz-"+a),void(window.chrome&&this.element.css("cursor","-webkit-"+a)))},redraw:function(){this._calcSize()},_mouseScroll:function(a){var b=0;return a||(a=window.event),a.originalEvent.wheelDelta?b=a.originalEvent.wheelDelta:a.originalEvent.detail&&(b=-a.originalEvent.detail),b>0?this.next():this.prev(),this._track("scroll",{domEvent:a,delta:b}),a.preventDefault(),!1},visible:function(a){a!=this._visible&&(this._super(a),a&&("visible"==this.options.preload&&this._startPreload(),"none"==this.options.preload&&this._startPreload(this._index),this.options.play.onVisible&&this._loaded&&this.playRepeat(this.options.play.repeat)))},_resolveEventCoords:function(a){return a=a.originalEvent,a.touches&&a.touches.length?{x:a.touches[0].clientX,y:a.touches[0].clientY}:a.changedTouches&&a.changedTouches.length?{x:a.changedTouches[0].clientX,y:a.changedTouches[0].clientY}:{x:a.clientX,y:a.clientY}},_startPreload:function(b){if(!(this._loaded||this._loading&&!this.first)){var c=this;this._loading=!0,this.first||(this._track("startPreload"),"none"!=this.options.preload&&("full"==this.options.preloadType?(this.pre=a('<li class="amp-progress amp-frame"></li>'),this.element.append(this.pre)):"window"==this.options.preloadType&&(this.progressIndicator=a('<div class="amp-progress-indicator"><div class="amp-progress-message"></div><div class="amp-progress-bar-background"><div class="amp-progress-bar"></div></div></div>'),this.progressIndicator.find(".amp-progress-message").html(this.options.progressMessage||"Loading..."),this.progressIndicator.progress=c.progressIndicator.find(".amp-progress-bar"),this.progressIndicator.visible=!0,this.element.append(this.progressIndicator))));var d=function(a){if(c.loadedCount++,c.loadedCount>=c.toLoadCount&&!c._loaded)c._unsetLoadEvents(c.imgs),c._loaded=!0,c.pre&&c.pre.remove(),c.options.play.onLoad&&c.playRepeat(c.options.play.repeat),c._loading=!1,c.progressIndicator&&(c.progressIndicator.visible=!1,c.progressIndicator.remove()),c._track("preloaded");else{var b=c.loadedCount/c.toLoadCount*100;c.pre&&(c.pre.css("width",100-b+"%"),c.pre.css("left",b+"%")),c.progressIndicator&&c.progressIndicator.visible&&c.progressIndicator.progress.css("width",b+"%")}};b?(this.first=!0,this.toLoadCount-=1,this._callImageMethod(a(this.imgs[b-1]),d)):this._callImageMethod(this.imgs,d)}},_unsetLoadEvents:function(b){if(b)for(var c=0,d=b.length;d>c;c++){var e=a(b[c]),f=e.data();f["amp-ampZoom"]?e.ampZoom({loaded:null}):e.ampImage({loaded:null})}},_callImageMethod:function(b,c){for(var d=0,e=b.length;e>d;d++){var f=a(b[d]),g=f.data();g["amp-ampZoom"]?(f.ampZoom({loaded:c}),f.ampZoom("load",this.options.preload)):(f.ampImage({loaded:c}),f.ampImage("load",this.options.preload))}},preload:function(){this._startPreload()},playRepeat:function(a){if("inf"==a)return void this.play();for(var b=this,c=0;a>c;c++)for(var d=0;d<this.count;d++)setTimeout(function(){b.next()},this.options.delay*(c*this.count+d))},_startDrag:function(b){var c=this,d=this._resolveEventCoords(b),e=a(b.currentTarget).offset(),f=d.x-e.left,g=d.y-e.top;if(!this._started){if(this.options.gesture.enabled&&b.originalEvent&&b.originalEvent.touches&&b.originalEvent.touches[0]&&b.originalEvent.touches.length!=this.options.gesture.fingers)return!0;this._started=!0,this._track("startMove",{domEvent:b,pos:{x:f,y:g}}),this._ended=!1,this.pause(),this._setCursor(this.options.cursor.active),this.element.removeClass(this.options.states.inactive).addClass(this.options.states.active);var h=this._mbind=function(a){return function(b){return c._mouseMove(b,e,f,g,a)}}(this._index),i=this._ubind=function(a){return function(b){return c._endDrag(b,e,f,g,a)}}(this._index);return this.$document.on(this.options.events.move,h),this.$document.on(this.options.events.end,i),this._mouseMoveInfo=[{e:b,o:e,mx:f,my:g,sindex:this._index}],window.navigator.userAgent.indexOf("MSIE ")>0?!1:void this.element.find(".amp-spin").each(function(c,d){var e=a(d).data().ampAmpSpin;e&&e._startDrag&&e._startDrag(b)})}},_mouseMove:function(a,b,c,d,e){if(this.options.gesture.enabled&&a.originalEvent&&a.originalEvent.touches&&a.originalEvent.touches[0]&&a.originalEvent.touches.length!=this.options.gesture.fingers)return!0;var f=this._resolveEventCoords(a),g=f.x-b.left,h=f.y-b.top,i=g-c,j=h-d,k=(this._mouseMoveInfo,{e:a,mx:g,my:h});return this.moveDir||(Math.abs(i)<Math.abs(j)?this.moveDir="vert":Math.abs(i)>Math.abs(j)?this.moveDir="horz":this.moveDir=this.options.orientation),this.options.orientation!=this.moveDir?!0:(this._mouseMoveInfo.push(k),this._mouseMoveInfo.length>2&&this._mouseMoveInfo.shift(),this._moveSpin("horz"==this.options.orientation?i:j,a,e),this.options.orientation==this.moveDir?!1:void 0)},_moveSpin:function(a,b,c){var d=Math.round(a/this.options.dragDistance*(this._count-1));"normal"==this.options.dir&&(d=0-d),this._track("move",{domEvent:b,distFromStart:a});var e=this._numToIndex(d+c);e!=this._index&&(this._checkLoop(e),this.goTo(e))},_checkLoop:function(a){Math.abs(this._index-a)>2&&(this._index>a?this._track("looped","forwards"):this._track("looped","backwards"))},_endDrag:function(a,b,c,d,e){"horz"==this.moveDir&&(a.preventDefault(),a.stopPropagation()),this.moveDir=null;var f=this;if(!this._ended)if(this._started=!1,this._ended=!0,this._track("endMove",{domEvent:a}),this.$document.off(this.options.events.end,this._ubind),this.$document.off(this.options.events.move,this._mbind),clearInterval(this._timer),this._setCursor(this.options.cursor.inactive),this.element.removeClass(this.options.states.active).addClass(this.options.states.inactive),this.options.momentum&&2==this._mouseMoveInfo.length){var g=this._mouseMoveInfo,h=g[1].e.timeStamp-g[0].e.timeStamp,i="horz"==this.options.orientation?g[1].mx-g[0].mx:g[1].my-g[0].my;if(0==i||0==h)return;var j=i/h,k=j,l=this.options.friction,m="horz"==this.options.orientation?g[1].mx-c:g[1].my-d,n=0,o=0,p=10;if(Math.abs(m)<this.options.minDistance)return;for(;Math.abs(k)>.1;)k*=l,n+=k*p,o+=p,setTimeout(function(b){return function(){f._moveSpin(b+m,a,e)}}(n),o)}else;},_calcSize:function(){this._super(),this.progressIndicator&&this.progressIndicator.visible&&(this.progressIndicator.css("top",(parseInt(a(this.element.find("li")[0]).css("height"))-parseInt(this.progressIndicator.css("height")))/2+"px"),this.progressIndicator.css("left",(parseInt(a(this.element.find("li")[0]).css("width"))-parseInt(this.progressIndicator.css("width")))/2+"px"))},_getIndex:function(a){var b=this.element.children();if(a>b.length){if(!this.options.loop)return;a=1}else if(1>a){if(!this.options.loop)return;a=b.length}},_direction:function(a){for(var b=0,c=0,d=a;d!=this._index;)d>this._count?d=0:d++,b++;for(d=a;d!=this._index;)1>d?d=this._count:d--,c++;return b>c?!0:!1},_loopIndex:function(a,b,c){for(var d=a?1:-1,e=b,f=0;c>f;f++)e+d>this._count?e=1:1>e+d?e=this._count:e+=d;return e},_loopCount:function(a,b,c){for(var d=a?1:-1,e=b,f=0;e!=c;)f++,e+d>this._count?e=1:1>e+d?e=this._count:e+=d;return f},_animate:function(a){var b=this.element,c=b.children("li").eq(this._index-1),d=b.children("li").eq(a-1);this._index!=a&&(d.addClass(this.options.states.selected+" "+this.options.states.seen),d.css("display","block"),c.removeClass(this.options.states.selected),c.css("display","none"),this._setIndex(a))},_track:function(a,b){this._trigger(a,null,b),window.amp&&amp.stats&&amp.stats.event&&amp.stats.event(this.element,"spin",a,b)},_destroy:function(){this.element.removeClass("amp"),this.element.removeClass("amp-spin"),this.element.removeClass(this.options.states.active),this.element.removeClass(this.options.states.inactive),this.element.css("cursor",""),this.element.find(".amp-progress").remove(),this.element.find(".amp-loading").remove(),this._removeEmptyAttributeHelper(this.element);var b=this.element.children();b.removeClass("amp-frame"),b.removeClass(this.options.states.selected),b.removeClass(this.options.states.seen),b.css("display","");for(var c=0,d=b.length;d>c;c++)this._removeEmptyAttributeHelper(a(b[c]));var e=b.find("img");e.removeClass("amp amp-main-img, amp-image"),e.css("display","");for(var c=0,d=e.length;d>c;c++)this._removeEmptyAttributeHelper(a(e[c]))}})}(jQuery),"undefined"!=typeof videojs&&videojs.plugin("resolutions",function(a){var b=this;if("undefined"!=typeof vjs){vjs.reduce=function(a,b,c,d){if(a&&0!==a.length){for(var e=0,f=a.length;f>e;e++)c=b.call(a,c,a[e],e);return c}},this.resolutions_={options_:{},stopStream:function(){switch(b.techName){case"Html5":break;case"Flash":b.tech.el_.vjs_stop()}b.src("")},removeSources:function(a){var c=b.el_.getElementsByTagName("video")[0];if("Html5"===b.techName&&c)for(var d=c.getElementsByTagName("source"),e=0;e<d.length;e++)c.removeChild(d[e])},bucketByTypes:function(a){return vjs.reduce(a,function(a,b,c){return(a[b.type]=a[b.type]||[]).push(b),a},{},b)},selectSource:function(a){this.removeSources();var b=this.bucketByTypes(a),c=this.selectTypeAndTech(a);return c?(this.options_.sourceResolutions=b[c.type],this.selectResolution(this.options_.sourceResolutions)):!1},selectTypeAndTech:function(a){for(var c,d,e=0,f=b.options_.techOrder;e<f.length;e++)if(c=videojs.capitalize(f[e]),d=window.videojs[c],d.isSupported())for(var g=0,h=a;g<h.length;g++){var i=h[g];if(d.canPlaySource(i))return{type:i.type,tech:c}}},selectResolution:function(a){var c=0,d=!!window.localStorage;videojs.obj.each(a,function(a,b){b.index=parseInt(a,10),b["data-default"]&&(c=b.index)},b);var e=c;if(d){var f=parseInt(window.localStorage.getItem("videojs_preferred_res"),10);isNaN(f)||(e=f)}var g=a.length-1,h=e>g?g:e;return a[h]}},b.resolution=function(){return this.cache_.src.res},b.changeResolution=function(a){if(this.cache_.src===a.src)return this.trigger("resolutionchange"),this;var b=this.currentTime(),c=this.paused();this.pause(),this.resolutions_.stopStream(),"Html5"===this.techName?this.src(a.src):this.loadTech(this.techName,{src:a.src}),this.ready(function(){this.one("loadeddata",vjs.bind(this,function(){this.currentTime(b)})),this.trigger("resolutionchange"),c||(this.load(),this.play()),vjs.setLocalStorage("videojs_preferred_res",parseInt(a.index,10))})};var c=videojs.MenuItem.extend({init:function(a,b){b.label=b.source["data-res"],videojs.MenuItem.call(this,a,b),this.source=b.source,this.resolution=b.source["data-res"],this.player_.one("loadstart",vjs.bind(this,this.update)),this.player_.on("resolutionchange",vjs.bind(this,this.update))}});c.prototype.onClick=function(){videojs.MenuItem.prototype.onClick.call(this),this.player_.changeResolution(this.source)},c.prototype.update=function(){var a=this.player_;a.cache_.src===this.source.src?this.selected(!0):this.selected(!1)};var d=videojs.MenuButton.extend({init:function(a,b){videojs.MenuButton.call(this,a,b),this.items.length<=1&&this.hide()}});d.prototype.sourceResolutions_,d.prototype.sourceResolutions=function(){return this.sourceResolutions_},d.prototype.onClick=function(a){if(a.target.className.match(/vjs-control-content/))this[this.el_.className.match(/touched/)?"removeClass":"addClass"]("touched");else{for(var b=$(".vjs-menu-button"),c=0;c<b.length;c++)videojs.removeClass(b[c],"touched");this.removeClass("touched")}},d.prototype.createItems=function(){for(var a=this.sourceResolutions_=this.player_.resolutions_.options_.sourceResolutions,b=[],d=0;d<a.length;d++)b.push(new c(this.player_,{source:this.sourceResolutions_[d]}));return b};var e=d.extend({init:function(a,b,c){d.call(this,a,b,c),this.el_.setAttribute("aria-label","Resolutions Menu"),this.el_.setAttribute("id","vjs-resolutions-button")}});e.prototype.kind_="resolutions",e.prototype.buttonText="Resolutions",e.prototype.className="vjs-resolutions-button",videojs.obj.merge(b.controlBar.options_.children,{resolutionsButton:{}});var f=b.resolutions_.selectSource(b.options_.sources);b.ready(function(){b.changeResolution(f);var a=new e(b);b.controlBar.addChild(a),delete b.controlBar.options_.children.resolutionsButton})}});